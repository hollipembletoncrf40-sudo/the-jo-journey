---
/**
 * Giscus 评论组件
 * 基于 GitHub Discussions
 */
---

<div class="giscus-wrapper" id="giscus-container">
  <div id="giscus-loading" class="text-center py-8 text-gray-500">
    <span class="i-lucide-loader-2 text-2xl animate-spin mb-2 block"></span>
    <p class="text-sm">加载评论中...</p>
  </div>
</div>

<script>
  function loadGiscus() {
    const container = document.getElementById('giscus-container');
    const loading = document.getElementById('giscus-loading');
    if (!container) return;
    
    const script = document.createElement('script');
    script.src = 'https://giscus.app/client.js';
    script.setAttribute('data-repo', 'hollipembletoncrf40-sudo/the-jo-journey');
    script.setAttribute('data-repo-id', 'R_kgDOQyI37Q');
    script.setAttribute('data-category', 'Announcements');
    script.setAttribute('data-category-id', 'DIC_kwDOQyI37c4C0djC');
    script.setAttribute('data-mapping', 'pathname');
    script.setAttribute('data-strict', '0');
    script.setAttribute('data-reactions-enabled', '1');
    script.setAttribute('data-emit-metadata', '0');
    script.setAttribute('data-input-position', 'bottom');
    script.setAttribute('data-theme', 'dark_dimmed');
    script.setAttribute('data-lang', 'zh-CN');
    script.crossOrigin = 'anonymous';
    script.async = true;
    
    script.onload = () => {
      if (loading) loading.style.display = 'none';
    };
    
    container.appendChild(script);
  }

  if (document.readyState === 'complete') {
    loadGiscus();
  } else {
    window.addEventListener('load', loadGiscus);
  }
</script>

<style>
  .giscus-wrapper {
    min-height: 200px;
  }
  
  @keyframes spin {
    to { transform: rotate(360deg); }
  }
  
  .animate-spin {
    animation: spin 1s linear infinite;
  }
</style>
